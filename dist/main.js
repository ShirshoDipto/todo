(()=>{"use strict";class t{constructor(t,e,i,l=0){this.title=t,this.todos=e,this.listNumber=i,this.isDefault=l}get getIsDefault(){return this.isDefault}set setIsDefault(t){this.isDefault=t}get getListNumber(){return this.listNumber}set setListNumber(t){this.listNumber=t}get getTitle(){return this.title}get getTodos(){return this.todos}set setTodos(t){this.todos=t}set setTitle(t){this.title=t}set setTodos(t){this.todos=t}addNewList(t){this.todos.push(t)}}class e{constructor(t,e,i,l,s,o,r){this.title=t,this.description=e,this.dueDate=i,this.priority=l,this.listNumber=s,this.completed=o,this.todoNumber=r}get getTodoNumber(){return this.todoNumber}set setTodoNumber(t){this.todoNumber=t}get getIsCompleted(){return this.completed}changeCompleteStatus(){1===this.completed?this.completed=0:this.completed=1}get getListNumber(){return this.listNumber}set setListNumber(t){this.listNumber=t}get getTitle(){return this.title}get getDescription(){return this.description}get getDueDate(){return this.dueDate}get getPriority(){return this.priority}set setTitle(t){this.title=t}set setDescription(t){this.description=t}set setDueDate(t){this.dueDate=t}set setPriority(t){this.priority=t}}let i=[];function l(t,e,l){i.push(t);const s=document.createElement("div");s.classList.add("a-list"),s.setAttribute("list-number",`${t.getListNumber}`),e.insertBefore(s,l);const o=document.createElement("div");o.classList.add("left"),s.appendChild(o);const r=document.createElement("div");r.classList.add("right"),s.appendChild(r);const n=document.createElement("img");n.classList.add("icon"),1===t.getIsDefault?n.setAttribute("src","icons/weather-sunny.png"):n.setAttribute("src","icons/todo.png"),o.appendChild(n);const d=document.createElement("div");d.classList.add("list-title"),d.textContent=t.getTitle,o.appendChild(d);const u=document.createElement("img");u.classList.add("edit"),u.setAttribute("src","icons/pencil.png"),r.appendChild(u);const c=document.createElement("img");return c.classList.add("delete"),c.setAttribute("src","icons/trash.png"),r.appendChild(c),s}function s(t){if(0===i.length)return;const e=t.firstElementChild;if("active-list"===e.getAttribute("id"))e.removeAttribute("id");else{let t=e.nextElementSibling;for(;;){if("active-list"===t.getAttribute("id")){t.removeAttribute("id");break}t=t.nextElementSibling}}}function o(t){let e=0;for(let l=0;l<i.length;l++)if(i[l].setListNumber=l,0!==i[l].getTodos.length){let s=0;const o=i[l].getListNumber;for(let r of i[l].getTodos){r.setListNumber=l,r.setTodoNumber=s;let i=t[e];i.removeAttribute("list-number"),i.setAttribute("list-number",`${o}`),i.removeAttribute("todo-number"),i.setAttribute("todo-number",`${s}`),s++,e++}}}let r=[];function n(t,e){r.push(e);const i=document.createElement("div");i.classList.add("a-todo"),i.setAttribute("list-number",`${e.getListNumber}`),i.setAttribute("todo-number",`${e.getTodoNumber}`),"none"===e.getPriority?i.classList.toggle("none"):"medium"===e.getPriority?i.classList.toggle("medium"):"high"===e.getPriority?i.classList.toggle("high"):"normal"===e.getPriority&&i.classList.toggle("normal"),t.appendChild(i);const l=document.createElement("div");l.classList.add("a-list"),i.appendChild(l);const s=document.createElement("div");s.classList.add("description"),s.textContent=e.getDescription,i.appendChild(s);const o=document.createElement("div");o.classList.add("collapse"),i.appendChild(o);const n=document.createElement("div");n.classList.add("left"),l.appendChild(n);const d=document.createElement("div");d.classList.add("right"),l.appendChild(d);const u=document.createElement("img");u.setAttribute("src","icons/unfold.png"),u.setAttribute("alt","collapse icon"),u.setAttribute("id","hide"),o.appendChild(u);const c=document.createElement("input");c.setAttribute("type","checkbox"),c.setAttribute("id","todo-checkbox"),c.setAttribute("name","todo-checkbox"),1===e.getIsCompleted&&(c.checked=!0),n.appendChild(c);const a=document.createElement("div");a.textContent=`${e.getTitle} (Due: ${e.getDueDate})`,n.appendChild(a);const m=document.createElement("img");m.setAttribute("src","icons/pencil.png"),m.classList.add("edit"),d.appendChild(m);const g=document.createElement("img");return g.setAttribute("src","icons/trash.png"),g.classList.add("delete"),d.appendChild(g),i}function d(t,e,i){null===e&&(t.firstElementChild.textContent=i),t.setAttribute("list-number",`${e}`),t.firstElementChild.textContent=i}function u(t,e){if(null!==t)for(let i of t)i.getAttribute("list-number")===e?i.removeAttribute("id"):i.setAttribute("id","hide")}function c(t,e){let i=0;for(let l of t){let t=l.getTitle,s=l.getDescription,o=l.dueDate,r=l.getPriority,n=l.getListNumber,d=l.getIsCompleted,u=l.getTodoNumber;localStorage.setItem(`list_${e}_todo_${i}`,`${t},${s},${o},${r},${n},${d},${u}`),i++}}function a(t,e){localStorage.clear();let i=0;localStorage.setItem("activeListNumber",e);for(let e of t){let t=e.getTitle,l=e.getListNumber;1===e.getIsDefault?localStorage.setItem(`list_${i}`,`${t},${l},1`):localStorage.setItem(`list_${i}`,`${t},${l}`),c(e.getTodos,i),i++}}let m="0";function g(t){var e;t.preventDefault(),console.log(m),i[parseInt(m)].setTitle=t.target.firstElementChild.value,t.target.previousElementSibling.textContent=t.target.firstElementChild.value,d($,m,t.target.firstElementChild.value),(e=t.target.parentNode.parentNode).firstElementChild.removeChild(e.firstElementChild.lastElementChild),e.firstElementChild.lastElementChild.removeAttribute("id"),a(i,m)}function h(t){if("delete"===t.target.classList.value)!function(t){if("a-list"===t.classList.value){const e=t.getAttribute("list-number");p.removeChild(t);const l=Array.from(document.querySelectorAll(".a-list"));let s=Array.from(document.querySelectorAll(".all-todo .a-todo"));!function(t,e,i){for(let l of e)l.getAttribute("list-number")===i&&t.removeChild(l)}(q,s,e),s=Array.from(document.querySelectorAll(".all-todo .a-todo")),function(t,e,l){i.splice(parseInt(e),1);let s=0;for(let e of t)e.removeAttribute("list-number"),e.setAttribute("list-number",`${s}`),s++;o(l)}(l,e,s),e===m&&function(t,e){0===i.length?d($,null,"Add a List"):"0"===e?(document.querySelector('.all-list div[list-number="0"]').setAttribute("id","active-list"),d($,e,i[0].getTitle),u(t,"0"),m="0"):(document.querySelector(`.all-list div[list-number="${parseInt(e)-1}"]`).setAttribute("id","active-list"),d($,e,i[parseInt(e)-1].getTitle),u(t,""+(parseInt(e)-1)),m=""+(parseInt(e)-1))}(s,e),m=document.querySelector("#active-list").getAttribute("list-number"),console.log(m)}a(i,m)}(this);else if("edit"===t.target.classList.value)(function(t){const e=t.firstElementChild.lastElementChild;e.setAttribute("id","hide");const i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("maxlength","30"),i.required=!0,i.value=e.textContent;const l=document.createElement("form");return l.setAttribute("action","#"),l.classList.add("edit-list-form"),t.firstElementChild.appendChild(l),l.appendChild(i),console.log(t),l}(this)).onsubmit=g;else{s(p),this.setAttribute("id","active-list");let t=this.getAttribute("list-number");d($,t,this.firstElementChild.lastElementChild.textContent),u(Array.from(document.querySelectorAll(".a-todo")),t),m=t,localStorage.removeItem("activeListNumber"),localStorage.setItem("activeListNumber",m)}console.log(i)}function b(t){!0===t.checked?t.checked=!1:t.checked=!0}function f(t){if("delete"===t.target.classList.value){const t=this.getAttribute("list-number"),e=this.getAttribute("todo-number");i[parseInt(t)].getTodos.splice(parseInt(e),1),console.table(i),q.removeChild(this),o(Array.from(document.querySelectorAll(".all-todo .a-todo")))}else if("edit"===t.target.classList.value){const t=document.querySelector(".edit-todo-modal");t.removeAttribute("id");const e=function(t,e,i){let l=t.getAttribute("list-number"),s=t.getAttribute("todo-number"),o=i[parseInt(l)].getTodos[parseInt(s)],r=e.firstElementChild.nextElementSibling;r.firstElementChild.value=o.getTitle,r.firstElementChild.nextElementSibling.lastElementChild.value=o.getDueDate;const n=o.getPriority;let d=r.firstElementChild.nextElementSibling.nextElementSibling.lastElementChild;return function(t,e){let i=e.firstElementChild;for(;;){if(i.getAttribute("value")===t){i.selected=!0;break}i=i.nextElementSibling}}(n,d),d.parentNode.nextElementSibling.value=o.getDescription,o}(this,t,i),l=t.lastElementChild;l.onsubmit=t=>{!function(t,e){e.preventDefault();const l=document.querySelector(`.all-todo div[todo-number="${t.getTodoNumber}"]`);l.classList.remove(t.getPriority),t.setTitle=e.target.firstElementChild.value,t.setDueDate=e.target.firstElementChild.nextElementSibling.lastElementChild.value,t.setPriority=e.target.firstElementChild.nextElementSibling.nextElementSibling.lastElementChild.value,t.setDescription=e.target.lastElementChild.previousElementSibling.value,e.target.parentNode.setAttribute("id","hide"),function(t,e){e.firstElementChild.firstElementChild.lastElementChild.textContent=`${t.getTitle} (Due: ${t.getDueDate})`,e.firstElementChild.nextElementSibling.textContent=`${t.getDescription}`,e.classList.toggle(t.getPriority)}(t,l),a(i,m)}(e,t)},l.onreset=()=>{t.setAttribute("id","hide")}}else{"checkbox"===t.target.getAttribute("type")&&b(t.target);const e=this.getAttribute("list-number"),l=this.getAttribute("todo-number");i[parseInt(e)].getTodos[parseInt(l)].changeCompleteStatus(),b(this.firstElementChild.firstElementChild.firstElementChild),console.log(this.firstElementChild.firstElementChild.firstElementChild)}a(i,m)}const p=document.querySelector(".all-list"),A=document.querySelector("#list-name"),C=document.querySelector(".list-form"),E=document.querySelector(".add-new-list"),v=document.querySelector(".new-list-modal"),y=document.querySelector(".add-todo"),S=document.querySelector(".new-todo-modal"),L=document.querySelector(".todo-form"),N=document.querySelector("#todo-name"),T=document.querySelector("#due-date"),D=document.querySelector("#priority"),I=document.querySelector("#description"),q=document.querySelector(".all-todo"),$=document.querySelector(".todo-header");if(localStorage.getItem("activeListNumber")){let s=function(){let i=[],l=[];for(let s in localStorage)if(s.includes("list")&&!s.includes("todo")){const e=localStorage.getItem(s).split(","),l=e[0],o=parseInt(e[1]);if(3===e.length){const e=new t(l,[],o,1);i.push(e)}else{const e=new t(l,[],o);i.push(e)}}else if(s.includes("todo")){const t=localStorage.getItem(s).split(","),i=t[0],o=t[1],r=t[2],n=t[3],d=parseInt(t[4]),u=parseInt(t[5]),c=parseInt(t[6]),a=new e(i,o,r,n,d,u,c);l.push(a)}let s=function(t){return t.sort(((t,e)=>t.getListNumber>e.getListNumber?1:-1))}(i);return function(t,e){for(let i of e)t[i.getListNumber].getTodos.push(i);for(let e of t){const t=e.getTodos.sort(((t,e)=>t.getTodoNumber>e.getTodoNumber?1:-1));e.setTodos=t}}(s,l),s}();m=localStorage.getItem("activeListNumber"),function(t){if(0===t.length)return;for(let e of t){l(e,p,v);for(let t of e.getTodos)n(q,t)}const e=document.querySelector(`.all-list div[list-number="${m}"]`);null!==e&&e.setAttribute("id","active-list");const s=Array.from(document.querySelectorAll(".a-todo"));d($,m,i[parseInt(m)].getTitle),u(s,m),console.log(i)}(s)}else{let e=new t("My Day",[],0,1);l(e,p,v),d($,"0","My Day"),document.querySelector(`.all-list div[list-number="${e.getListNumber}"]`).setAttribute("id","active-list"),a(i,m)}const x=document.querySelectorAll(".all-list .a-list"),k=document.querySelectorAll(".all-todo .a-todo");y.onclick=()=>{S.removeAttribute("id")},E.addEventListener("click",(()=>{v.removeAttribute("id"),p.scrollTo(0,p.scrollHeight)})),C.onsubmit=function(e){console.log(e.target),e.preventDefault();let o=new t(A.value,[],i.length);s(p);const r=l(o,p,v);r.setAttribute("id","active-list");const n=Array.from(document.querySelectorAll(".a-todo"));d($,o.getListNumber,o.getTitle),u(n,o.getListNumber.toString()),m=o.getListNumber.toString(),r.onclick=h,e.target.reset(),v.setAttribute("id","hide"),p.scrollTo(0,p.scrollHeight),console.log(i),a(i,m)},C.onreset=()=>{v.setAttribute("id","hide")},L.onsubmit=function(t){t.preventDefault();const l=parseInt($.getAttribute("list-number")),s=i[parseInt(l)].getTodos.length;let o=new e(N.value,I.value,T.value,D.value,l,0,s);i[parseInt(l)].getTodos.push(o),n(q,o).onclick=f,S.setAttribute("id","hide"),q.scrollTo(0,q.scrollHeight),t.target.reset(),console.table(i),a(i,m)},L.onreset=()=>{S.setAttribute("id","hide")},x.forEach((t=>{t.onclick=h})),k.forEach((t=>{t.onclick=f}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFvQnlDLEVBQVM2QyxHQUNyQ2EsUUFBVTNDLEVBR3JCbUIsRUFBYXJHLGFBQWEsS0FBTSxRQUNoQ21FLEVBQVE0RCxTQUFTLEVBQUc1RCxFQUFRNkQsY0FDNUIvRSxFQUFFTSxPQUFPNEUsUUFDVC9FLFFBQVErQixNQUFNN0YsR0FDZHNELEVBQVN0RCxFQUFPdUQsRUFDcEIsRUFzT0F5RCxFQUFTTixRQUFVLEtBQ2ZLLEVBQWFyRyxhQUFhLEtBQU0sT0FBTyxFQUczQzJILEVBQWVTLFNBQVEvRCxJQUNuQkEsRUFBS3dELFFBQVVqRSxDQUFjLElBR2pDZ0UsRUFBWVEsU0FBUS9GLElBQ2hCQSxFQUFLd0YsUUFBVTNDLENBQVUsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3RvZG8vLi9zcmMvbGlzdC5qcyIsIndlYnBhY2s6Ly90b2RvLy4vc3JjL3RvZG8uanMiLCJ3ZWJwYWNrOi8vdG9kby8uL3NyYy9tYW5hZ2VMaXN0SW50ZXJmYWNlLmpzIiwid2VicGFjazovL3RvZG8vLi9zcmMvbWFuYWdlVG9kb0ludGVyZmFjZS5qcyIsIndlYnBhY2s6Ly90b2RvLy4vc3JjL3N0b3JhZ2VNYW5hZ2VtZW50LmpzIiwid2VicGFjazovL3RvZG8vLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIExpc3Qge1xuICAgIGNvbnN0cnVjdG9yKHRpdGxlLCB0b2RvcywgbGlzdE51bWJlciwgaXNEZWZhdWx0PTApIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgICAgICB0aGlzLnRvZG9zID0gdG9kb3M7XG4gICAgICAgIHRoaXMubGlzdE51bWJlciA9IGxpc3ROdW1iZXI7XG4gICAgICAgIHRoaXMuaXNEZWZhdWx0ID0gaXNEZWZhdWx0O1xuICAgIH1cblxuICAgIGdldCBnZXRJc0RlZmF1bHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzRGVmYXVsdDtcbiAgICB9XG5cbiAgICBzZXQgc2V0SXNEZWZhdWx0KHZhbHVlKSB7XG4gICAgICAgIHRoaXMuaXNEZWZhdWx0ID0gdmFsdWU7XG4gICAgfVxuXG4gICAgZ2V0IGdldExpc3ROdW1iZXIoKSB7cmV0dXJuIHRoaXMubGlzdE51bWJlcn1cblxuICAgIHNldCBzZXRMaXN0TnVtYmVyKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubGlzdE51bWJlciA9IHZhbHVlO1xuICAgIH1cblxuICAgIGdldCBnZXRUaXRsZSgpIHtyZXR1cm4gdGhpcy50aXRsZX1cblxuICAgIGdldCBnZXRUb2RvcygpIHtyZXR1cm4gdGhpcy50b2Rvc31cblxuICAgIHNldCBzZXRUb2Rvcyh2YWx1ZSkge1xuICAgICAgICB0aGlzLnRvZG9zID0gdmFsdWU7XG4gICAgfVxuXG4gICAgc2V0IHNldFRpdGxlKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudGl0bGUgPSB2YWx1ZTtcbiAgICB9XG5cbiAgICBzZXQgc2V0VG9kb3ModmFsdWUpIHtcbiAgICAgICAgdGhpcy50b2RvcyA9IHZhbHVlO1xuICAgIH1cblxuICAgIGFkZE5ld0xpc3QodGhlVG9kbykge1xuICAgICAgICB0aGlzLnRvZG9zLnB1c2godGhlVG9kbyk7XG4gICAgfVxufSIsIlxuXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRvZG8ge1xuXG4gICAgY29uc3RydWN0b3IodGl0bGUsIGRlc2NyaXB0aW9uLCBkdWVEYXRlLCBwcmlvcml0eSwgbGlzdE51bWJlciwgY29tcGxldGVkLCB0b2RvTnVtYmVyKSB7XG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgICB0aGlzLmR1ZURhdGUgPSBkdWVEYXRlO1xuICAgICAgICB0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHk7XG4gICAgICAgIHRoaXMubGlzdE51bWJlciA9IGxpc3ROdW1iZXI7XG4gICAgICAgIHRoaXMuY29tcGxldGVkID0gY29tcGxldGVkO1xuICAgICAgICB0aGlzLnRvZG9OdW1iZXIgPSB0b2RvTnVtYmVyO1xuICAgIH1cblxuICAgIGdldCBnZXRUb2RvTnVtYmVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50b2RvTnVtYmVyO1xuICAgIH1cblxuICAgIHNldCBzZXRUb2RvTnVtYmVyKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudG9kb051bWJlciA9IHZhbHVlO1xuICAgIH1cblxuICAgIGdldCBnZXRJc0NvbXBsZXRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tcGxldGVkO1xuICAgIH1cblxuICAgIGNoYW5nZUNvbXBsZXRlU3RhdHVzKCkge1xuICAgICAgICBpZiAodGhpcy5jb21wbGV0ZWQgPT09IDEpIHtcbiAgICAgICAgICAgIHRoaXMuY29tcGxldGVkID0gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY29tcGxldGVkID0gMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBnZXRMaXN0TnVtYmVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5saXN0TnVtYmVyO1xuICAgIH1cblxuICAgIHNldCBzZXRMaXN0TnVtYmVyKHZhbHVlKSB7XG4gICAgICAgIHRoaXMubGlzdE51bWJlciA9IHZhbHVlO1xuICAgIH1cblxuICAgIGdldCBnZXRUaXRsZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGl0bGU7XG4gICAgfVxuICAgIGdldCBnZXREZXNjcmlwdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVzY3JpcHRpb247XG4gICAgfVxuICAgIGdldCBnZXREdWVEYXRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kdWVEYXRlO1xuICAgIH1cbiAgICBnZXQgZ2V0UHJpb3JpdHkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByaW9yaXR5O1xuICAgIH1cblxuICAgIHNldCBzZXRUaXRsZSh2YWx1ZSkge1xuICAgICAgICB0aGlzLnRpdGxlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgc2V0IHNldERlc2NyaXB0aW9uKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IHNldER1ZURhdGUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5kdWVEYXRlID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBzZXRQcmlvcml0eSh2YWx1ZSkge1xuICAgICAgICB0aGlzLnByaW9yaXR5ID0gdmFsdWU7XG4gICAgfVxufSIsIlxuXG5leHBvcnQgbGV0IGxpc3RzID0gW107XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGROZXdMaXN0SW50ZXJmYWNlKGxpc3RPYmplY3QsIGNvbnRhaW5lciwgaW5zZXJ0X2JlZm9yZSkge1xuXG4gICAgbGlzdHMucHVzaChsaXN0T2JqZWN0KTtcblxuICAgIGNvbnN0IGFMaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgYUxpc3QuY2xhc3NMaXN0LmFkZCgnYS1saXN0Jyk7XG4gICAgYUxpc3Quc2V0QXR0cmlidXRlKCdsaXN0LW51bWJlcicsIGAke2xpc3RPYmplY3QuZ2V0TGlzdE51bWJlcn1gKTtcbiAgICAvLyBhTGlzdC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2FjdGl2ZS1saXN0Jyk7XG4gICAgY29udGFpbmVyLmluc2VydEJlZm9yZShhTGlzdCwgaW5zZXJ0X2JlZm9yZSk7XG5cblxuICAgIGNvbnN0IGxlZnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBsZWZ0LmNsYXNzTGlzdC5hZGQoJ2xlZnQnKTtcbiAgICBhTGlzdC5hcHBlbmRDaGlsZChsZWZ0KTtcblxuICAgIGNvbnN0IHJpZ2h0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgcmlnaHQuY2xhc3NMaXN0LmFkZCgncmlnaHQnKTtcbiAgICBhTGlzdC5hcHBlbmRDaGlsZChyaWdodCk7XG5cbiAgICBjb25zdCBpY29uMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgIGljb24xLmNsYXNzTGlzdC5hZGQoJ2ljb24nKTtcbiAgICBpZiAobGlzdE9iamVjdC5nZXRJc0RlZmF1bHQgPT09IDEpIHtcbiAgICAgICAgaWNvbjEuc2V0QXR0cmlidXRlKCdzcmMnLCAnaWNvbnMvd2VhdGhlci1zdW5ueS5wbmcnKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGljb24xLnNldEF0dHJpYnV0ZSgnc3JjJywgJ2ljb25zL3RvZG8ucG5nJyk7XG4gICAgfVxuICAgIGxlZnQuYXBwZW5kQ2hpbGQoaWNvbjEpO1xuXG4gICAgY29uc3QgbGlzdFRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgbGlzdFRpdGxlLmNsYXNzTGlzdC5hZGQoJ2xpc3QtdGl0bGUnKTtcbiAgICBsaXN0VGl0bGUudGV4dENvbnRlbnQgPSBsaXN0T2JqZWN0LmdldFRpdGxlO1xuICAgIGxlZnQuYXBwZW5kQ2hpbGQobGlzdFRpdGxlKTtcblxuICAgIGNvbnN0IGljb24yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgaWNvbjIuY2xhc3NMaXN0LmFkZCgnZWRpdCcpO1xuICAgIGljb24yLnNldEF0dHJpYnV0ZSgnc3JjJywgJ2ljb25zL3BlbmNpbC5wbmcnKTtcbiAgICByaWdodC5hcHBlbmRDaGlsZChpY29uMik7XG5cbiAgICAvLyBjb25zdCBpY29uMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgIC8vIGljb24zLmNsYXNzTGlzdC5hZGQoJ3VwLWFycm93Jyk7XG4gICAgLy8gaWNvbjMuc2V0QXR0cmlidXRlKCdzcmMnLCAnaWNvbnMvYXJyb3ctdXAucG5nJyk7XG4gICAgLy8gcmlnaHQuYXBwZW5kQ2hpbGQoaWNvbjMpO1xuXG4gICAgLy8gY29uc3QgaWNvbjQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICAvLyBpY29uNC5jbGFzc0xpc3QuYWRkKCdkb3duLWFycm93Jyk7XG4gICAgLy8gaWNvbjQuc2V0QXR0cmlidXRlKCdzcmMnLCAnaWNvbnMvYXJyb3ctZG93bi5wbmcnKTtcbiAgICAvLyByaWdodC5hcHBlbmRDaGlsZChpY29uNCk7XG5cbiAgICBjb25zdCBpY29uNSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgIGljb241LmNsYXNzTGlzdC5hZGQoJ2RlbGV0ZScpO1xuICAgIGljb241LnNldEF0dHJpYnV0ZSgnc3JjJywgJ2ljb25zL3RyYXNoLnBuZycpO1xuICAgIHJpZ2h0LmFwcGVuZENoaWxkKGljb241KTtcblxuICAgIHJldHVybiBhTGlzdDtcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlRXhpc3RpbmdNYXJrZXIoY29udGFpbmVyKSB7XG4gICAgaWYgKGxpc3RzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuICAgIGNvbnN0IGZpcnN0TGlzdCA9IGNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICBpZiAoZmlyc3RMaXN0LmdldEF0dHJpYnV0ZSgnaWQnKSA9PT0gJ2FjdGl2ZS1saXN0Jykge1xuICAgICAgICBmaXJzdExpc3QucmVtb3ZlQXR0cmlidXRlKCdpZCcpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbGV0IG5leHRMaXN0ID0gZmlyc3RMaXN0Lm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgIGlmIChuZXh0TGlzdC5nZXRBdHRyaWJ1dGUoJ2lkJykgPT09ICdhY3RpdmUtbGlzdCcpe1xuICAgICAgICAgICAgICAgIG5leHRMaXN0LnJlbW92ZUF0dHJpYnV0ZSgnaWQnKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5leHRMaXN0ID0gbmV4dExpc3QubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVBcnJheUFuZFRvZG8oYWxsVG9kb3MpIHtcbiAgICBsZXQgYWxsVG9kb0luZGV4ID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxpc3RzW2ldLnNldExpc3ROdW1iZXIgPSBpO1xuICAgICAgICBpZiAobGlzdHNbaV0uZ2V0VG9kb3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGxldCB0b2RvX25vID0gMDtcbiAgICAgICAgICAgIGNvbnN0IGxpc3Rfbm8gPSBsaXN0c1tpXS5nZXRMaXN0TnVtYmVyO1xuICAgICAgICAgICAgZm9yIChsZXQgeCBvZiBsaXN0c1tpXS5nZXRUb2Rvcykge1xuICAgICAgICAgICAgICAgIHguc2V0TGlzdE51bWJlciA9IGk7XG4gICAgICAgICAgICAgICAgeC5zZXRUb2RvTnVtYmVyID0gdG9kb19ubztcbiAgICAgICAgICAgICAgICBsZXQgdGhlRE9NID0gYWxsVG9kb3NbYWxsVG9kb0luZGV4XTtcbiAgICAgICAgICAgICAgICB0aGVET00ucmVtb3ZlQXR0cmlidXRlKCdsaXN0LW51bWJlcicpO1xuICAgICAgICAgICAgICAgIHRoZURPTS5zZXRBdHRyaWJ1dGUoJ2xpc3QtbnVtYmVyJywgYCR7bGlzdF9ub31gKTtcbiAgICAgICAgICAgICAgICB0aGVET00ucmVtb3ZlQXR0cmlidXRlKCd0b2RvLW51bWJlcicpO1xuICAgICAgICAgICAgICAgIHRoZURPTS5zZXRBdHRyaWJ1dGUoJ3RvZG8tbnVtYmVyJywgYCR7dG9kb19ub31gKTtcbiAgICAgICAgICAgICAgICB0b2RvX25vKys7XG4gICAgICAgICAgICAgICAgYWxsVG9kb0luZGV4Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVMaXN0c0FuZFRvZG9zKGNvbnRhaW5lciwgbGlzdE51bWJlciwgYWxsVG9kb3MpIHtcblxuICAgIGxpc3RzLnNwbGljZShwYXJzZUludChsaXN0TnVtYmVyKSwgMSk7XG4gICAgLy8gIHVwZGF0ZSBkb21zXG4gICAgbGV0IGluZGV4ID0gMDtcblxuICAgIGZvciAobGV0IGxpc3Qgb2YgY29udGFpbmVyKSB7XG4gICAgICAgIGxpc3QucmVtb3ZlQXR0cmlidXRlKCdsaXN0LW51bWJlcicpO1xuICAgICAgICBsaXN0LnNldEF0dHJpYnV0ZSgnbGlzdC1udW1iZXInLCBgJHtpbmRleH1gKTtcbiAgICAgICAgaW5kZXgrKztcbiAgICB9XG5cbiAgICAvLyB1cGRhdGUgQXJyYXkgYW5kIHRvZG8gRE9NJ3NcbiAgICB1cGRhdGVBcnJheUFuZFRvZG8oYWxsVG9kb3MpO1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBlZGl0TGlzdChlbGVtZW50KSB7XG4gICAgY29uc3QgbGlzdFRpdGxlID0gZWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZC5sYXN0RWxlbWVudENoaWxkO1xuICAgIGxpc3RUaXRsZS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2hpZGUnKTtcblxuICAgIC8vIGNyZWF0ZSBhbiBpbnB1dCBFbGVtZW50XG4gICAgY29uc3QgbGlzdE5hbWVJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgbGlzdE5hbWVJbnB1dC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dCcpO1xuICAgIGxpc3ROYW1lSW5wdXQuc2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnLCAnMzAnKTtcbiAgICBsaXN0TmFtZUlucHV0LnJlcXVpcmVkID0gdHJ1ZTtcbiAgICBsaXN0TmFtZUlucHV0LnZhbHVlID0gbGlzdFRpdGxlLnRleHRDb250ZW50O1xuXG4gICAgLy8gY3JlYXRlIHRoZSBmb3JtXG4gICAgY29uc3QgbGlzdE5hbWVGb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZm9ybScpO1xuICAgIGxpc3ROYW1lRm9ybS5zZXRBdHRyaWJ1dGUoJ2FjdGlvbicsICcjJyk7XG4gICAgbGlzdE5hbWVGb3JtLmNsYXNzTGlzdC5hZGQoJ2VkaXQtbGlzdC1mb3JtJylcblxuICAgIGVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQuYXBwZW5kQ2hpbGQobGlzdE5hbWVGb3JtKTtcbiAgICBsaXN0TmFtZUZvcm0uYXBwZW5kQ2hpbGQobGlzdE5hbWVJbnB1dCk7XG4gICAgY29uc29sZS5sb2coZWxlbWVudCk7XG5cbiAgICByZXR1cm4gbGlzdE5hbWVGb3JtO1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiB1bmRvQ2hhbmdlKGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LmZpcnN0RWxlbWVudENoaWxkLnJlbW92ZUNoaWxkKGVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQubGFzdEVsZW1lbnRDaGlsZCk7XG4gICAgZWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZC5sYXN0RWxlbWVudENoaWxkLnJlbW92ZUF0dHJpYnV0ZSgnaWQnKTtcbn0iLCJcblxuZXhwb3J0IGxldCB0b2RvcyA9IFtdO1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBhZGROZXdUb2RvSW50ZXJmYWNlKGNvbnRhaW5lciwgdGhlVG9kbykge1xuXG4gICAgLy8gZGVzY3JpcHRpb25zIGdvZXMgaGVyZVxuXG4gICAgdG9kb3MucHVzaCh0aGVUb2RvKTtcblxuICAgIGNvbnN0IGFUb2RvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgYVRvZG8uY2xhc3NMaXN0LmFkZCgnYS10b2RvJyk7XG4gICAgYVRvZG8uc2V0QXR0cmlidXRlKCdsaXN0LW51bWJlcicsIGAke3RoZVRvZG8uZ2V0TGlzdE51bWJlcn1gKTtcbiAgICBhVG9kby5zZXRBdHRyaWJ1dGUoJ3RvZG8tbnVtYmVyJywgYCR7dGhlVG9kby5nZXRUb2RvTnVtYmVyfWApO1xuICAgIGlmICh0aGVUb2RvLmdldFByaW9yaXR5ID09PSAnbm9uZScpIHtcbiAgICAgICAgYVRvZG8uY2xhc3NMaXN0LnRvZ2dsZSgnbm9uZScpXG4gICAgfVxuICAgIGVsc2UgaWYgKHRoZVRvZG8uZ2V0UHJpb3JpdHkgPT09ICdtZWRpdW0nKSB7XG4gICAgICAgIGFUb2RvLmNsYXNzTGlzdC50b2dnbGUoJ21lZGl1bScpXG4gICAgfVxuICAgIGVsc2UgaWYgKHRoZVRvZG8uZ2V0UHJpb3JpdHkgPT09ICdoaWdoJykge1xuICAgICAgICBhVG9kby5jbGFzc0xpc3QudG9nZ2xlKCdoaWdoJylcbiAgICB9XG4gICAgZWxzZSBpZiAodGhlVG9kby5nZXRQcmlvcml0eSA9PT0gJ25vcm1hbCcpIHtcbiAgICAgICAgYVRvZG8uY2xhc3NMaXN0LnRvZ2dsZSgnbm9ybWFsJylcbiAgICB9XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGFUb2RvKTtcblxuICAgIGNvbnN0IGFMaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgYUxpc3QuY2xhc3NMaXN0LmFkZCgnYS1saXN0Jyk7XG4gICAgYVRvZG8uYXBwZW5kQ2hpbGQoYUxpc3QpO1xuXG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBkZXNjcmlwdGlvbi5jbGFzc0xpc3QuYWRkKCdkZXNjcmlwdGlvbicpO1xuICAgIGRlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdGhlVG9kby5nZXREZXNjcmlwdGlvbjtcbiAgICBhVG9kby5hcHBlbmRDaGlsZChkZXNjcmlwdGlvbik7XG5cbiAgICBjb25zdCBjb2xsYXBzZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbGxhcHNlLmNsYXNzTGlzdC5hZGQoJ2NvbGxhcHNlJyk7XG4gICAgYVRvZG8uYXBwZW5kQ2hpbGQoY29sbGFwc2UpO1xuXG4gICAgY29uc3QgbGVmdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGxlZnQuY2xhc3NMaXN0LmFkZCgnbGVmdCcpO1xuICAgIGFMaXN0LmFwcGVuZENoaWxkKGxlZnQpO1xuXG4gICAgY29uc3QgcmlnaHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICByaWdodC5jbGFzc0xpc3QuYWRkKCdyaWdodCcpO1xuICAgIGFMaXN0LmFwcGVuZENoaWxkKHJpZ2h0KTtcblxuICAgIGNvbnN0IGNvbGxhcHNlSW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgY29sbGFwc2VJbWcuc2V0QXR0cmlidXRlKCdzcmMnLCAnaWNvbnMvdW5mb2xkLnBuZycpO1xuICAgIGNvbGxhcHNlSW1nLnNldEF0dHJpYnV0ZSgnYWx0JywgJ2NvbGxhcHNlIGljb24nKTtcbiAgICBjb2xsYXBzZUltZy5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2hpZGUnKTtcbiAgICBjb2xsYXBzZS5hcHBlbmRDaGlsZChjb2xsYXBzZUltZyk7XG5cbiAgICBjb25zdCBpbnB1dDEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgIGlucHV0MS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnY2hlY2tib3gnKTtcbiAgICBpbnB1dDEuc2V0QXR0cmlidXRlKCdpZCcsICd0b2RvLWNoZWNrYm94Jyk7XG4gICAgaW5wdXQxLnNldEF0dHJpYnV0ZSgnbmFtZScsICd0b2RvLWNoZWNrYm94Jyk7XG4gICAgaWYgKHRoZVRvZG8uZ2V0SXNDb21wbGV0ZWQgPT09IDEpIHtcbiAgICAgICAgaW5wdXQxLmNoZWNrZWQgPSB0cnVlO1xuICAgIH1cbiAgICBsZWZ0LmFwcGVuZENoaWxkKGlucHV0MSk7XG5cbiAgICBjb25zdCB0aXRsZVRvZG8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aXRsZVRvZG8udGV4dENvbnRlbnQgPSBgJHt0aGVUb2RvLmdldFRpdGxlfSAoRHVlOiAke3RoZVRvZG8uZ2V0RHVlRGF0ZX0pYDtcbiAgICBsZWZ0LmFwcGVuZENoaWxkKHRpdGxlVG9kbyk7XG5cbiAgICBjb25zdCBpY29uMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgIGljb24yLnNldEF0dHJpYnV0ZSgnc3JjJywgJ2ljb25zL3BlbmNpbC5wbmcnKTtcbiAgICBpY29uMi5jbGFzc0xpc3QuYWRkKCdlZGl0Jyk7XG4gICAgcmlnaHQuYXBwZW5kQ2hpbGQoaWNvbjIpO1xuXG4gICAgLy8gY29uc3QgaWNvbjMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICAvLyBpY29uMy5zZXRBdHRyaWJ1dGUoJ3NyYycsICdpY29ucy9hcnJvdy11cC5wbmcnKTtcbiAgICAvLyBpY29uMy5jbGFzc0xpc3QuYWRkKCd1cC1hcnJvdycpO1xuICAgIC8vIHJpZ2h0LmFwcGVuZENoaWxkKGljb24zKTtcblxuICAgIC8vIGNvbnN0IGljb240ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgLy8gaWNvbjQuc2V0QXR0cmlidXRlKCdzcmMnLCAnaWNvbnMvYXJyb3ctZG93bi5wbmcnKTtcbiAgICAvLyBpY29uNC5jbGFzc0xpc3QuYWRkKCdkb3duLWFycm93Jyk7XG4gICAgLy8gcmlnaHQuYXBwZW5kQ2hpbGQoaWNvbjQpO1xuXG4gICAgY29uc3QgaWNvbjUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICBpY29uNS5zZXRBdHRyaWJ1dGUoJ3NyYycsICdpY29ucy90cmFzaC5wbmcnKTtcbiAgICBpY29uNS5jbGFzc0xpc3QuYWRkKCdkZWxldGUnKTtcbiAgICByaWdodC5hcHBlbmRDaGlsZChpY29uNSk7XG5cbiAgICByZXR1cm4gYVRvZG87XG59XG5cblxuLy8gY2hhbmdlIHRvZG8gaGVhZGVyXG5leHBvcnQgZnVuY3Rpb24gY2hhbmdlVG9kb0hlYWRlcih0b2RvSGVhZGVyLCBsaXN0TnVtYmVyLCB0aXRsZSkge1xuICAgIGlmIChsaXN0TnVtYmVyID09PSBudWxsKSB7XG4gICAgICAgIHRvZG9IZWFkZXIuZmlyc3RFbGVtZW50Q2hpbGQudGV4dENvbnRlbnQgPSB0aXRsZTtcbiAgICB9XG4gICAgdG9kb0hlYWRlci5zZXRBdHRyaWJ1dGUoJ2xpc3QtbnVtYmVyJywgYCR7bGlzdE51bWJlcn1gKTtcbiAgICB0b2RvSGVhZGVyLmZpcnN0RWxlbWVudENoaWxkLnRleHRDb250ZW50ID0gdGl0bGU7XG59XG5cbi8vIHNob3cgYWxsIHRvZG9zIG9mIGEgcGFydGljdWxhciBsaXN0XG5leHBvcnQgZnVuY3Rpb24gc2hvd0xpc3RzVG9kb3MoYWxsVG9kb3MsIGxpc3ROdW1iZXIpIHtcbiAgICBpZiAoYWxsVG9kb3MgPT09IG51bGwpIHJldHVyblxuICAgIGZvciAobGV0IHRvZG8gb2YgYWxsVG9kb3MpIHtcbiAgICAgICAgaWYgKHRvZG8uZ2V0QXR0cmlidXRlKCdsaXN0LW51bWJlcicpID09PSBsaXN0TnVtYmVyKSB7XG4gICAgICAgICAgICB0b2RvLnJlbW92ZUF0dHJpYnV0ZSgnaWQnKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRvZG8uc2V0QXR0cmlidXRlKCdpZCcsICdoaWRlJyk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZVJlbGF0ZWRUb2RvKGNvbnRhaW5lciwgYWxsVG9kb3MsIGxpc3ROdW1iZXIpIHtcbiAgICBmb3IgKGxldCB0b2RvIG9mIGFsbFRvZG9zKSB7XG4gICAgICAgIGNvbnN0IGxpc3RfbnVtID0gdG9kby5nZXRBdHRyaWJ1dGUoJ2xpc3QtbnVtYmVyJyk7XG4gICAgICAgIGlmIChsaXN0X251bSA9PT0gbGlzdE51bWJlcikge1xuICAgICAgICAgICAgY29udGFpbmVyLnJlbW92ZUNoaWxkKHRvZG8pO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5cbmZ1bmN0aW9uIHNldFByaW9yaXR5VmFsdWUoc2VsZWN0ZWRPbmUsIHByaW9yaXR5SW5wdXQpIHtcblxuICAgIGxldCBpbnB1dCA9IHByaW9yaXR5SW5wdXQuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgaWYgKGlucHV0LmdldEF0dHJpYnV0ZSgndmFsdWUnKSA9PT0gc2VsZWN0ZWRPbmUpIHtcbiAgICAgICAgICAgIGlucHV0LnNlbGVjdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlucHV0ID0gaW5wdXQubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgIH1cbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gZWRpdFRvZG8oZWxlbWVudCwgZWRpdE1vZGFsLCBsaXN0cykge1xuICAgIGxldCBsaXN0TnVtYmVyID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2xpc3QtbnVtYmVyJyk7XG4gICAgbGV0IHRvZG9OdW1iZXIgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgndG9kby1udW1iZXInKTtcbiAgICBsZXQgdGhlVG9kbyA9IGxpc3RzW3BhcnNlSW50KGxpc3ROdW1iZXIpXS5nZXRUb2Rvc1twYXJzZUludCh0b2RvTnVtYmVyKV07XG4gICAgbGV0IGVkaXRGb3JtID0gZWRpdE1vZGFsLmZpcnN0RWxlbWVudENoaWxkLm5leHRFbGVtZW50U2libGluZztcbiAgICBlZGl0Rm9ybS5maXJzdEVsZW1lbnRDaGlsZC52YWx1ZSA9IHRoZVRvZG8uZ2V0VGl0bGU7XG4gICAgZWRpdEZvcm0uZmlyc3RFbGVtZW50Q2hpbGQubmV4dEVsZW1lbnRTaWJsaW5nLmxhc3RFbGVtZW50Q2hpbGQudmFsdWUgPSB0aGVUb2RvLmdldER1ZURhdGU7XG4gICAgY29uc3Qgc2VsZWN0ZWRPbmUgPSB0aGVUb2RvLmdldFByaW9yaXR5O1xuICAgIGxldCBwcmlvcml0eUlucHV0ID0gZWRpdEZvcm0uZmlyc3RFbGVtZW50Q2hpbGQubmV4dEVsZW1lbnRTaWJsaW5nLm5leHRFbGVtZW50U2libGluZy5sYXN0RWxlbWVudENoaWxkO1xuICAgIHNldFByaW9yaXR5VmFsdWUoc2VsZWN0ZWRPbmUsIHByaW9yaXR5SW5wdXQpO1xuICAgIHByaW9yaXR5SW5wdXQucGFyZW50Tm9kZS5uZXh0RWxlbWVudFNpYmxpbmcudmFsdWUgPSB0aGVUb2RvLmdldERlc2NyaXB0aW9uO1xuXG4gICAgcmV0dXJuIHRoZVRvZG87XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVRvZG9ET00odGhlVG9kbywgdG9kb0RPTSkge1xuICAgIHRvZG9ET00uZmlyc3RFbGVtZW50Q2hpbGQuZmlyc3RFbGVtZW50Q2hpbGQubGFzdEVsZW1lbnRDaGlsZC50ZXh0Q29udGVudCA9IGAke3RoZVRvZG8uZ2V0VGl0bGV9IChEdWU6ICR7dGhlVG9kby5nZXREdWVEYXRlfSlgO1xuICAgIHRvZG9ET00uZmlyc3RFbGVtZW50Q2hpbGQubmV4dEVsZW1lbnRTaWJsaW5nLnRleHRDb250ZW50ID0gYCR7dGhlVG9kby5nZXREZXNjcmlwdGlvbn1gXG4gICAgdG9kb0RPTS5jbGFzc0xpc3QudG9nZ2xlKHRoZVRvZG8uZ2V0UHJpb3JpdHkpO1xufSIsImltcG9ydCBMaXN0IGZyb20gJy4vbGlzdCdcbmltcG9ydCBUb2RvIGZyb20gJy4vdG9kbydcblxuXG5cbmV4cG9ydCBmdW5jdGlvbiBzYXZlVG9kbyhhbkFycmF5LCBsKSB7XG4gICAgbGV0IHQgPSAwO1xuICAgIGZvciAobGV0IHRvZG8gb2YgYW5BcnJheSkge1xuICAgICAgICBsZXQgdGl0bGUgPSB0b2RvLmdldFRpdGxlO1xuICAgICAgICBsZXQgZGVzY3JpcHRpb24gPSB0b2RvLmdldERlc2NyaXB0aW9uO1xuICAgICAgICBsZXQgZHVlRGF0ZSA9IHRvZG8uZHVlRGF0ZTtcbiAgICAgICAgbGV0IHByaW9yaXR5ID0gdG9kby5nZXRQcmlvcml0eTtcbiAgICAgICAgbGV0IGxpc3ROdW1iZXIgPSB0b2RvLmdldExpc3ROdW1iZXI7XG4gICAgICAgIGxldCBjb21wbGV0ZWQgPSB0b2RvLmdldElzQ29tcGxldGVkO1xuICAgICAgICBsZXQgdG9kb051bWJlciA9IHRvZG8uZ2V0VG9kb051bWJlcjtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYGxpc3RfJHtsfV90b2RvXyR7dH1gLCBgJHt0aXRsZX0sJHtkZXNjcmlwdGlvbn0sJHtkdWVEYXRlfSwke3ByaW9yaXR5fSwke2xpc3ROdW1iZXJ9LCR7Y29tcGxldGVkfSwke3RvZG9OdW1iZXJ9YCk7XG4gICAgICAgIHQrKztcbiAgICB9XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIHNhdmVEYXRhKGxpc3RzLCBhY3RpdmVMaXN0TnVtYmVyKSB7XG4gICAgbG9jYWxTdG9yYWdlLmNsZWFyKClcbiAgICBsZXQgbCA9IDA7XG5cbiAgICAvLyBzYXZlIGxpc3RzXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FjdGl2ZUxpc3ROdW1iZXInLCBhY3RpdmVMaXN0TnVtYmVyKTtcbiAgICBmb3IgKGxldCBlbGVtIG9mIGxpc3RzKSB7XG4gICAgICAgIGxldCBsaXN0VGl0bGUgPSBlbGVtLmdldFRpdGxlO1xuICAgICAgICBsZXQgbGlzdE51bWJlciA9IGVsZW0uZ2V0TGlzdE51bWJlcjtcbiAgICAgICAgaWYgKGVsZW0uZ2V0SXNEZWZhdWx0ID09PSAxKSB7XG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYGxpc3RfJHtsfWAsIGAke2xpc3RUaXRsZX0sJHtsaXN0TnVtYmVyfSwxYCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShgbGlzdF8ke2x9YCwgYCR7bGlzdFRpdGxlfSwke2xpc3ROdW1iZXJ9YCk7XG4gICAgICAgIH1cbiAgICAgICAgc2F2ZVRvZG8oZWxlbS5nZXRUb2RvcywgbCk7XG4gICAgICAgIGwrKztcbiAgICB9XG59XG5cblxuZnVuY3Rpb24gc29ydEFycmF5cyhhcnJheUxpc3RzKSB7XG4gICAgY29uc3QgbmV3TGlzdHMgPSBhcnJheUxpc3RzLnNvcnQoKGEsYikgPT4ge1xuICAgICAgICBpZiAoYS5nZXRMaXN0TnVtYmVyID4gYi5nZXRMaXN0TnVtYmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gbmV3TGlzdHM7XG59XG5cbmZ1bmN0aW9uIGluc2VydFRvZG9zVG9MaXN0cyhmaW5hbEFycmF5LCBhcnJheVRvZG9zKSB7XG4gICAgZm9yIChsZXQgdG9kbyBvZiBhcnJheVRvZG9zKSB7XG4gICAgICAgIGZpbmFsQXJyYXlbdG9kby5nZXRMaXN0TnVtYmVyXS5nZXRUb2Rvcy5wdXNoKHRvZG8pO1xuICAgIH1cbiAgICAvLyBzb3J0IHRoZSB0b2Rvc1xuICAgIGZvciAobGV0IGxpc3Qgb2YgZmluYWxBcnJheSkge1xuICAgICAgICBjb25zdCBuZXdUb2RvID0gbGlzdC5nZXRUb2Rvcy5zb3J0KChhLGIpID0+IHtcbiAgICAgICAgICAgIGlmIChhLmdldFRvZG9OdW1iZXIgPiBiLmdldFRvZG9OdW1iZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgbGlzdC5zZXRUb2RvcyA9IG5ld1RvZG87XG4gICAgfVxufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBsb2FkRGF0YSgpIHtcbiAgICBsZXQgYXJyYXlMaXN0cyA9IFtdO1xuICAgIGxldCBhcnJheVRvZG9zID0gW107XG4gICAgZm9yIChsZXQgZWxlbSBpbiBsb2NhbFN0b3JhZ2UpIHtcbiAgICAgICAgaWYgKGVsZW0uaW5jbHVkZXMoJ2xpc3QnKSAmJiAhZWxlbS5pbmNsdWRlcygndG9kbycpKSB7XG4gICAgICAgICAgICBjb25zdCBsaXN0RGV0YWlscyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGVsZW0pLnNwbGl0KCcsJyk7XG4gICAgICAgICAgICBjb25zdCB0aXRsZSA9IGxpc3REZXRhaWxzWzBdO1xuICAgICAgICAgICAgY29uc3QgbGlzdE51bWJlciA9IHBhcnNlSW50KGxpc3REZXRhaWxzWzFdKTtcbiAgICAgICAgICAgIGlmIChsaXN0RGV0YWlscy5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdMaXN0ID0gbmV3IExpc3QodGl0bGUsIFtdLCBsaXN0TnVtYmVyLCAxKTtcbiAgICAgICAgICAgICAgICBhcnJheUxpc3RzLnB1c2gobmV3TGlzdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdMaXN0ID0gbmV3IExpc3QodGl0bGUsIFtdLCBsaXN0TnVtYmVyKTtcbiAgICAgICAgICAgICAgICBhcnJheUxpc3RzLnB1c2gobmV3TGlzdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZWxlbS5pbmNsdWRlcygndG9kbycpKSB7XG4gICAgICAgICAgICBjb25zdCB0b2RvRGV0YWlscyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGVsZW0pLnNwbGl0KCcsJyk7XG4gICAgICAgICAgICBjb25zdCB0aXRsZSA9IHRvZG9EZXRhaWxzWzBdO1xuICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSB0b2RvRGV0YWlsc1sxXTtcbiAgICAgICAgICAgIGNvbnN0IGR1ZURhdGUgPSB0b2RvRGV0YWlsc1syXTtcbiAgICAgICAgICAgIGNvbnN0IHByaW9yaXR5ID0gdG9kb0RldGFpbHNbM107XG4gICAgICAgICAgICBjb25zdCBsaXN0TnVtYmVyID0gcGFyc2VJbnQodG9kb0RldGFpbHNbNF0pO1xuICAgICAgICAgICAgY29uc3QgY29tcGxldGVkID0gcGFyc2VJbnQodG9kb0RldGFpbHNbNV0pO1xuICAgICAgICAgICAgY29uc3QgdG9kb051bWJlciA9IHBhcnNlSW50KHRvZG9EZXRhaWxzWzZdKTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1RvZG8gPSBuZXcgVG9kbyh0aXRsZSwgZGVzY3JpcHRpb24sIGR1ZURhdGUsIHByaW9yaXR5LCBsaXN0TnVtYmVyLCBjb21wbGV0ZWQsIHRvZG9OdW1iZXIpO1xuICAgICAgICAgICAgYXJyYXlUb2Rvcy5wdXNoKG5ld1RvZG8pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGxldCBmaW5hbEFycmF5ID0gc29ydEFycmF5cyhhcnJheUxpc3RzKTtcbiAgICBpbnNlcnRUb2Rvc1RvTGlzdHMoZmluYWxBcnJheSwgYXJyYXlUb2Rvcyk7XG4gICAgcmV0dXJuIGZpbmFsQXJyYXk7XG4gICAgY29uc29sZS5sb2coJ3ByaW50aW5nIHRoZSBjb252ZXJ0ZWQgYXJyYXknKVxuICAgIGNvbnNvbGUubG9nKGZpbmFsQXJyYXkpO1xufSIsImltcG9ydCBMaXN0IGZyb20gJy4vbGlzdCdcbmltcG9ydCBUb2RvIGZyb20gJy4vdG9kbydcbmltcG9ydCB7bGlzdHMsIGFkZE5ld0xpc3RJbnRlcmZhY2UsIHJlbW92ZUV4aXN0aW5nTWFya2VyLCB1cGRhdGVMaXN0c0FuZFRvZG9zLCB1cGRhdGVBcnJheUFuZFRvZG8sIGVkaXRMaXN0LCB1bmRvQ2hhbmdlfSBmcm9tICcuL21hbmFnZUxpc3RJbnRlcmZhY2UnXG5pbXBvcnQge2FkZE5ld1RvZG9JbnRlcmZhY2UsIGNoYW5nZVRvZG9IZWFkZXIsIHNob3dMaXN0c1RvZG9zLCBkZWxldGVSZWxhdGVkVG9kbywgZWRpdFRvZG8sIHVwZGF0ZVRvZG9ET019IGZyb20gJy4vbWFuYWdlVG9kb0ludGVyZmFjZSdcbmltcG9ydCB7c2F2ZURhdGEsIGxvYWREYXRhfSBmcm9tICcuL3N0b3JhZ2VNYW5hZ2VtZW50J1xuXG5sZXQgYWN0aXZlTGlzdE51bWJlciA9ICcwJztcblxuXG5mdW5jdGlvbiBhZGRMaXN0KGUpIHtcbiAgICBjb25zb2xlLmxvZyhlLnRhcmdldCk7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgLy8gbWFuYWdlIEFycmF5IG9mIGxpc3RzXG4gICAgbGV0IG5ld0xpc3QgPSBuZXcgTGlzdChuZXdMaXN0aW5wdXQudmFsdWUsIFtdLCBsaXN0cy5sZW5ndGgpO1xuICAgIHJlbW92ZUV4aXN0aW5nTWFya2VyKGFsbExpc3QpO1xuICAgIGNvbnN0IG5ld0xpc3RET00gPSBhZGROZXdMaXN0SW50ZXJmYWNlKG5ld0xpc3QsIGFsbExpc3QsIG5ld0xpc3RNb2RhbCk7XG4gICAgbmV3TGlzdERPTS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2FjdGl2ZS1saXN0Jyk7XG4gICAgY29uc3QgYWxsVG9kb3MgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hLXRvZG8nKSk7XG5cbiAgICAvLyBtYW5hZ2UgdG9kbyBpbnRlcmZhY2VcbiAgICBjaGFuZ2VUb2RvSGVhZGVyKHRvZG9IZWFkZXIsIG5ld0xpc3QuZ2V0TGlzdE51bWJlciwgbmV3TGlzdC5nZXRUaXRsZSk7XG4gICAgc2hvd0xpc3RzVG9kb3MoYWxsVG9kb3MsIG5ld0xpc3QuZ2V0TGlzdE51bWJlci50b1N0cmluZygpKTtcbiAgICBhY3RpdmVMaXN0TnVtYmVyID0gbmV3TGlzdC5nZXRMaXN0TnVtYmVyLnRvU3RyaW5nKCk7XG4gICAgbmV3TGlzdERPTS5vbmNsaWNrID0gbWFrZUxpc3RBY3RpdmU7XG4gICAgZS50YXJnZXQucmVzZXQoKTtcbiAgICBuZXdMaXN0TW9kYWwuc2V0QXR0cmlidXRlKCdpZCcsICdoaWRlJyk7XG4gICAgYWxsTGlzdC5zY3JvbGxUbygwLCBhbGxMaXN0LnNjcm9sbEhlaWdodCk7XG4gICAgY29uc29sZS5sb2cobGlzdHMpO1xuICAgIHNhdmVEYXRhKGxpc3RzLCBhY3RpdmVMaXN0TnVtYmVyKTtcbn1cblxuXG5mdW5jdGlvbiBhZGRfYV9Ub2RvKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAvLyBtYW5hZ2UgQXJyYXkgb2YgbGlzdHNcbiAgICBjb25zdCBsaXN0TnVtYmVyID0gcGFyc2VJbnQodG9kb0hlYWRlci5nZXRBdHRyaWJ1dGUoJ2xpc3QtbnVtYmVyJykpO1xuICAgIGNvbnN0IHRvZG9OdW1iZXIgPSBsaXN0c1twYXJzZUludChsaXN0TnVtYmVyKV0uZ2V0VG9kb3MubGVuZ3RoO1xuICAgIGxldCBuZXdUb2RvID0gbmV3IFRvZG8odG9kb05hbWUudmFsdWUsIGRlc2NyaXB0aW9uLnZhbHVlLCBkdWVEYXRlLnZhbHVlLCBwcmlvcml0eS52YWx1ZSwgbGlzdE51bWJlciwgMCwgdG9kb051bWJlcik7XG4gICAgbGlzdHNbcGFyc2VJbnQobGlzdE51bWJlcildLmdldFRvZG9zLnB1c2gobmV3VG9kbyk7XG5cblxuICAgIC8vIGJyaW5nIHRoZSB0b2RvIGludGVyZmFjZVxuICAgIGNvbnN0IG5ld1RvZG9ET00gPSBhZGROZXdUb2RvSW50ZXJmYWNlKGFsbFRvZG8sIG5ld1RvZG8pO1xuICAgIG5ld1RvZG9ET00ub25jbGljayA9IG1vZGlmeVRvZG87XG5cbiAgICAvLyBoaWRlIG1vZGFsXG4gICAgbmV3VG9kb01vZGFsLnNldEF0dHJpYnV0ZSgnaWQnLCAnaGlkZScpO1xuICAgIGFsbFRvZG8uc2Nyb2xsVG8oMCwgYWxsVG9kby5zY3JvbGxIZWlnaHQpO1xuICAgIGUudGFyZ2V0LnJlc2V0KCk7XG4gICAgY29uc29sZS50YWJsZShsaXN0cyk7XG4gICAgc2F2ZURhdGEobGlzdHMsIGFjdGl2ZUxpc3ROdW1iZXIpO1xufVxuXG5cbmZ1bmN0aW9uIHNhdmVFZGl0ZWRMaXN0KGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc29sZS5sb2coYWN0aXZlTGlzdE51bWJlcik7XG4gICAgbGV0IHRoZUxpc3QgPSBsaXN0c1twYXJzZUludChhY3RpdmVMaXN0TnVtYmVyKV07XG4gICAgdGhlTGlzdC5zZXRUaXRsZSA9IGUudGFyZ2V0LmZpcnN0RWxlbWVudENoaWxkLnZhbHVlO1xuICAgIGUudGFyZ2V0LnByZXZpb3VzRWxlbWVudFNpYmxpbmcudGV4dENvbnRlbnQgPSBlLnRhcmdldC5maXJzdEVsZW1lbnRDaGlsZC52YWx1ZTtcbiAgICAvLyBjb25zb2xlLmxvZyhlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUpO1xuICAgIGxldCBsaXN0TnVtYmVyID0gYWN0aXZlTGlzdE51bWJlcjtcbiAgICBjaGFuZ2VUb2RvSGVhZGVyKHRvZG9IZWFkZXIsIGxpc3ROdW1iZXIsIGUudGFyZ2V0LmZpcnN0RWxlbWVudENoaWxkLnZhbHVlKTtcbiAgICB1bmRvQ2hhbmdlKGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZSk7XG4gICAgc2F2ZURhdGEobGlzdHMsIGFjdGl2ZUxpc3ROdW1iZXIpO1xufVxuXG5cbmZ1bmN0aW9uIG1ha2VMaXN0QWN0aXZlKGUpIHtcbiAgICAvLyBoYW5kbGUgZGVsZXRlLCB1cCwgZG93biwgY29tcGxldGVcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlID09PSAnZGVsZXRlJykge1xuICAgICAgICBkZWxldGVFbGVtZW50KHRoaXMpO1xuICAgIH1cbiAgICBlbHNlIGlmIChlLnRhcmdldC5jbGFzc0xpc3QudmFsdWUgPT09ICdlZGl0Jykge1xuICAgICAgICBjb25zdCBsaXN0TmFtZUZvcm0gPSBlZGl0TGlzdCh0aGlzKTtcbiAgICAgICAgbGlzdE5hbWVGb3JtLm9uc3VibWl0ID0gc2F2ZUVkaXRlZExpc3Q7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZW1vdmVFeGlzdGluZ01hcmtlcihhbGxMaXN0KTtcbiAgICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2FjdGl2ZS1saXN0Jyk7XG4gICAgICAgIFxuICAgICAgICAvLyBnZXQgdGhlIGxpc3RPYmplY3RcbiAgICAgICAgbGV0IGxpc3ROdW1iZXIgPSB0aGlzLmdldEF0dHJpYnV0ZSgnbGlzdC1udW1iZXInKTtcbiAgICAgICAgY2hhbmdlVG9kb0hlYWRlcih0b2RvSGVhZGVyLCBsaXN0TnVtYmVyLCB0aGlzLmZpcnN0RWxlbWVudENoaWxkLmxhc3RFbGVtZW50Q2hpbGQudGV4dENvbnRlbnQpO1xuICAgICAgICBjb25zdCBhbGxUb2RvcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmEtdG9kbycpKTtcbiAgICAgICAgc2hvd0xpc3RzVG9kb3MoYWxsVG9kb3MsIGxpc3ROdW1iZXIpO1xuICAgICAgICBhY3RpdmVMaXN0TnVtYmVyID0gbGlzdE51bWJlcjtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2FjdGl2ZUxpc3ROdW1iZXInKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FjdGl2ZUxpc3ROdW1iZXInLCBhY3RpdmVMaXN0TnVtYmVyKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhsaXN0cyk7XG59XG5cblxuZnVuY3Rpb24gc2hvd1JlbGF0ZWRUb2Rvcyh4LCBsaXN0Tm8pe1xuICAgIGlmIChsaXN0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY2hhbmdlVG9kb0hlYWRlcih0b2RvSGVhZGVyLCBudWxsLCAnQWRkIGEgTGlzdCcpO1xuICAgIH1cbiAgICBlbHNlIGlmIChsaXN0Tm8gPT09IGAwYCkge1xuICAgICAgICBjb25zdCBhY3RpdmVMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFsbC1saXN0IGRpdltsaXN0LW51bWJlcj1cIjBcIl0nKTtcbiAgICAgICAgYWN0aXZlTGlzdC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2FjdGl2ZS1saXN0Jyk7XG4gICAgICAgIGNoYW5nZVRvZG9IZWFkZXIodG9kb0hlYWRlciwgbGlzdE5vLCBsaXN0c1swXS5nZXRUaXRsZSk7XG4gICAgICAgIHNob3dMaXN0c1RvZG9zKHgsIGAwYCk7XG4gICAgICAgIGFjdGl2ZUxpc3ROdW1iZXIgPSAnMCc7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb25zdCBhY3RpdmVMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmFsbC1saXN0IGRpdltsaXN0LW51bWJlcj1cIiR7cGFyc2VJbnQobGlzdE5vKS0xfVwiXWApO1xuICAgICAgICBhY3RpdmVMaXN0LnNldEF0dHJpYnV0ZSgnaWQnLCAnYWN0aXZlLWxpc3QnKTtcbiAgICAgICAgY2hhbmdlVG9kb0hlYWRlcih0b2RvSGVhZGVyLCBsaXN0Tm8sIGxpc3RzW3BhcnNlSW50KGxpc3RObyktMV0uZ2V0VGl0bGUpO1xuICAgICAgICBzaG93TGlzdHNUb2Rvcyh4LCBgJHtwYXJzZUludChsaXN0Tm8pLTF9YCk7XG4gICAgICAgIGFjdGl2ZUxpc3ROdW1iZXIgPSBgJHtwYXJzZUludChsaXN0Tm8pLTF9YDtcbiAgICB9XG59XG5cblxuZnVuY3Rpb24gZGVsZXRlRWxlbWVudChlbGVtZW50KSB7XG4gICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0LnZhbHVlID09PSAnYS1saXN0Jykge1xuICAgICAgICBjb25zdCBpbmRleCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdsaXN0LW51bWJlcicpO1xuICAgICAgICAvLyByZW1vdmVFeGlzdGluZ01hcmtlcihhbGxMaXN0KTtcbiAgICAgICAgYWxsTGlzdC5yZW1vdmVDaGlsZChlbGVtZW50KVxuICAgICAgICBjb25zdCBjb250YWluZXIgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hLWxpc3QnKSk7XG4gICAgICAgIGxldCB4ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYWxsLXRvZG8gLmEtdG9kbycpKTtcbiAgICAgICAgZGVsZXRlUmVsYXRlZFRvZG8oYWxsVG9kbywgeCwgaW5kZXgpO1xuICAgICAgICB4ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYWxsLXRvZG8gLmEtdG9kbycpKTtcbiAgICAgICAgdXBkYXRlTGlzdHNBbmRUb2Rvcyhjb250YWluZXIsIGluZGV4LCB4KTtcbiAgICAgICAgaWYgKGluZGV4ID09PSBhY3RpdmVMaXN0TnVtYmVyKSB7XG4gICAgICAgICAgICBzaG93UmVsYXRlZFRvZG9zKHgsIGluZGV4KTt9XG4gICAgICAgIGFjdGl2ZUxpc3ROdW1iZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWN0aXZlLWxpc3QnKS5nZXRBdHRyaWJ1dGUoJ2xpc3QtbnVtYmVyJyk7XG4gICAgICAgIGNvbnNvbGUubG9nKGFjdGl2ZUxpc3ROdW1iZXIpO1xuICAgIH1cbiAgICBzYXZlRGF0YShsaXN0cywgYWN0aXZlTGlzdE51bWJlcik7XG59XG5cbmZ1bmN0aW9uIGNoYW5nZUNoZWNrKGVsZW1lbnQpIHtcbiAgICBpZiAoZWxlbWVudC5jaGVja2VkID09PSB0cnVlKSB7XG4gICAgICAgIGVsZW1lbnQuY2hlY2tlZCA9IGZhbHNlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZWxlbWVudC5jaGVja2VkID0gdHJ1ZTtcbiAgICB9XG59XG5cblxuZnVuY3Rpb24gdXBkYXRlRGF0YXModGhlVG9kbywgZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCB0b2RvRE9NID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLmFsbC10b2RvIGRpdlt0b2RvLW51bWJlcj1cIiR7dGhlVG9kby5nZXRUb2RvTnVtYmVyfVwiXWApO1xuICAgIHRvZG9ET00uY2xhc3NMaXN0LnJlbW92ZSh0aGVUb2RvLmdldFByaW9yaXR5KTtcbiAgICB0aGVUb2RvLnNldFRpdGxlID0gZS50YXJnZXQuZmlyc3RFbGVtZW50Q2hpbGQudmFsdWU7XG4gICAgdGhlVG9kby5zZXREdWVEYXRlID0gZS50YXJnZXQuZmlyc3RFbGVtZW50Q2hpbGQubmV4dEVsZW1lbnRTaWJsaW5nLmxhc3RFbGVtZW50Q2hpbGQudmFsdWU7XG4gICAgdGhlVG9kby5zZXRQcmlvcml0eSA9IGUudGFyZ2V0LmZpcnN0RWxlbWVudENoaWxkLm5leHRFbGVtZW50U2libGluZy5uZXh0RWxlbWVudFNpYmxpbmcubGFzdEVsZW1lbnRDaGlsZC52YWx1ZTtcbiAgICB0aGVUb2RvLnNldERlc2NyaXB0aW9uID0gZS50YXJnZXQubGFzdEVsZW1lbnRDaGlsZC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLnZhbHVlO1xuICAgIGUudGFyZ2V0LnBhcmVudE5vZGUuc2V0QXR0cmlidXRlKCdpZCcsICdoaWRlJyk7XG4gICAgdXBkYXRlVG9kb0RPTSh0aGVUb2RvLCB0b2RvRE9NKTtcbiAgICBzYXZlRGF0YShsaXN0cywgYWN0aXZlTGlzdE51bWJlcik7XG59XG5cblxuZnVuY3Rpb24gbW9kaWZ5VG9kbyhlKSB7XG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC52YWx1ZSA9PT0gJ2RlbGV0ZScpIHtcbiAgICAgICAgY29uc3QgbGlzdE51bWJlciA9IHRoaXMuZ2V0QXR0cmlidXRlKCdsaXN0LW51bWJlcicpO1xuICAgICAgICBjb25zdCB0b2RvTnVtYmVyID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ3RvZG8tbnVtYmVyJyk7XG5cbiAgICAgICAgLy8gZGVsZXRlIHRvZG8gZnJvbSB0aGUgbGlzdHMgQXJyYXkgYW5kIHRoZSBkb21cbiAgICAgICAgbGlzdHNbcGFyc2VJbnQobGlzdE51bWJlcildLmdldFRvZG9zLnNwbGljZShwYXJzZUludCh0b2RvTnVtYmVyKSwgMSk7XG4gICAgICAgIGNvbnNvbGUudGFibGUobGlzdHMpO1xuICAgICAgICBhbGxUb2RvLnJlbW92ZUNoaWxkKHRoaXMpO1xuXG4gICAgICAgIC8vIHVwZGF0ZSB0b2RvIGFycmF5XG4gICAgICAgIGNvbnN0IGFsbFRvZG9zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYWxsLXRvZG8gLmEtdG9kbycpKTtcbiAgICAgICAgdXBkYXRlQXJyYXlBbmRUb2RvKGFsbFRvZG9zKTtcbiAgICB9XG4gICAgZWxzZSBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlID09PSAnZWRpdCcpIHtcbiAgICAgICAgY29uc3QgZWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmVkaXQtdG9kby1tb2RhbCcpO1xuICAgICAgICBlZGl0TW9kYWwucmVtb3ZlQXR0cmlidXRlKCdpZCcpO1xuICAgICAgICBjb25zdCB0aGVUb2RvID0gZWRpdFRvZG8odGhpcywgZWRpdE1vZGFsLCBsaXN0cyk7XG4gICAgICAgIGNvbnN0IGVkaXRGb3JtID0gZWRpdE1vZGFsLmxhc3RFbGVtZW50Q2hpbGQ7XG4gICAgICAgIGVkaXRGb3JtLm9uc3VibWl0ID0gKGUpID0+IHtcbiAgICAgICAgICAgIHVwZGF0ZURhdGFzKHRoZVRvZG8sIGUpO1xuICAgICAgICB9XG4gICAgICAgIGVkaXRGb3JtLm9ucmVzZXQgPSAoKSA9PiB7XG4gICAgICAgICAgICBlZGl0TW9kYWwuc2V0QXR0cmlidXRlKCdpZCcsICdoaWRlJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSA9PT0gJ2NoZWNrYm94Jykge1xuICAgICAgICAgICAgY2hhbmdlQ2hlY2soZS50YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGxpc3ROdW1iZXIgPSB0aGlzLmdldEF0dHJpYnV0ZSgnbGlzdC1udW1iZXInKTtcbiAgICAgICAgY29uc3QgdG9kb051bWJlciA9IHRoaXMuZ2V0QXR0cmlidXRlKCd0b2RvLW51bWJlcicpO1xuICAgICAgICBsZXQgdGhlTGlzdCA9IGxpc3RzW3BhcnNlSW50KGxpc3ROdW1iZXIpXTtcbiAgICAgICAgbGV0IHRoZVRvZG8gPSB0aGVMaXN0LmdldFRvZG9zW3BhcnNlSW50KHRvZG9OdW1iZXIpXTtcbiAgICAgICAgdGhlVG9kby5jaGFuZ2VDb21wbGV0ZVN0YXR1cygpO1xuICAgICAgICBjaGFuZ2VDaGVjayh0aGlzLmZpcnN0RWxlbWVudENoaWxkLmZpcnN0RWxlbWVudENoaWxkLmZpcnN0RWxlbWVudENoaWxkKTtcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5maXJzdEVsZW1lbnRDaGlsZC5maXJzdEVsZW1lbnRDaGlsZC5maXJzdEVsZW1lbnRDaGlsZCk7XG4gICAgfVxuICAgIHNhdmVEYXRhKGxpc3RzLCBhY3RpdmVMaXN0TnVtYmVyKTtcbn1cblxuXG5mdW5jdGlvbiBsb2FkUGFnZShhbkFycmF5KSB7XG4gICAgaWYgKGFuQXJyYXkubGVuZ3RoID09PSAwKSByZXR1cm47XG4gICAgZm9yIChsZXQgbGlzdCBvZiBhbkFycmF5KSB7XG4gICAgICAgIGFkZE5ld0xpc3RJbnRlcmZhY2UobGlzdCwgYWxsTGlzdCwgbmV3TGlzdE1vZGFsKTtcbiAgICAgICAgZm9yIChsZXQgdG9kbyBvZiBsaXN0LmdldFRvZG9zKSB7XG4gICAgICAgICAgICBhZGROZXdUb2RvSW50ZXJmYWNlKGFsbFRvZG8sIHRvZG8pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGFjdGl2ZUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuYWxsLWxpc3QgZGl2W2xpc3QtbnVtYmVyPVwiJHthY3RpdmVMaXN0TnVtYmVyfVwiXWApO1xuICAgIC8vIHJlbW92ZUV4aXN0aW5nTWFya2VyKGFsbExpc3QpO1xuICAgIGlmIChhY3RpdmVMaXN0ICE9PSBudWxsKSB7XG4gICAgICAgIGFjdGl2ZUxpc3Quc2V0QXR0cmlidXRlKCdpZCcsICdhY3RpdmUtbGlzdCcpO1xuICAgIH1cbiAgICBjb25zdCBhbGxUb2RvcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmEtdG9kbycpKTtcbiAgICBjaGFuZ2VUb2RvSGVhZGVyKHRvZG9IZWFkZXIsIGFjdGl2ZUxpc3ROdW1iZXIsIGxpc3RzW3BhcnNlSW50KGFjdGl2ZUxpc3ROdW1iZXIpXS5nZXRUaXRsZSk7XG4gICAgc2hvd0xpc3RzVG9kb3MoYWxsVG9kb3MsIGFjdGl2ZUxpc3ROdW1iZXIpO1xuICAgIGNvbnNvbGUubG9nKGxpc3RzKTtcbn1cblxuXG4vLyAjIyMjIyMjIyMjIyMjIyBNQUlOIEZVTkNUSU9OICMjIyMjIyMjIyMjIyMjIyMjXG5cblxuLy8gQWxsIGdsb2JhbCB2YXJpYWJsZXMgYW5kIGV2ZW50TGlzdGVuZXJzXG5jb25zdCBhbGxMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFsbC1saXN0Jyk7XG5jb25zdCBuZXdMaXN0aW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGlzdC1uYW1lJyk7XG5jb25zdCBsaXN0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5saXN0LWZvcm0nKTtcbmNvbnN0IGFkZE5ld0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLW5ldy1saXN0Jyk7XG5jb25zdCBuZXdMaXN0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmV3LWxpc3QtbW9kYWwnKTtcbmNvbnN0IGFkZFRvZG8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWRkLXRvZG8nKTtcbmNvbnN0IG5ld1RvZG9Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uZXctdG9kby1tb2RhbCcpO1xuY29uc3QgdG9kb0Zvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9kby1mb3JtJyk7XG5jb25zdCB0b2RvTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0b2RvLW5hbWUnKTtcbmNvbnN0IGR1ZURhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZHVlLWRhdGUnKTtcbmNvbnN0IHByaW9yaXR5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3ByaW9yaXR5Jyk7XG5jb25zdCBkZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkZXNjcmlwdGlvbicpO1xuY29uc3QgYWxsVG9kbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hbGwtdG9kbycpO1xuY29uc3QgdG9kb0hlYWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50b2RvLWhlYWRlcicpO1xuXG5cblxuLy8gbG9hZGluZyB0aGUgZXhpc3RpbmcgZGF0YVxuaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhY3RpdmVMaXN0TnVtYmVyJykpIHtcbiAgICBsZXQgYW5BcnJheSA9IGxvYWREYXRhKCk7XG4gICAgYWN0aXZlTGlzdE51bWJlciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhY3RpdmVMaXN0TnVtYmVyJyk7XG4gICAgbG9hZFBhZ2UoYW5BcnJheSk7XG4gICAgLy8gbG9hZFBhZ2UoYW5BcnJheSk7XG59XG5lbHNlIHtcbiAgICAvLyBBZGRpbmcgZGVmYXVsdCBsaXN0XG4gICAgbGV0IGRlZmF1bHRMaXN0ID0gbmV3IExpc3QoJ015IERheScsIFtdLCAwLCAxKTtcbiAgICBhZGROZXdMaXN0SW50ZXJmYWNlKGRlZmF1bHRMaXN0LCBhbGxMaXN0LCBuZXdMaXN0TW9kYWwpO1xuICAgIGNoYW5nZVRvZG9IZWFkZXIodG9kb0hlYWRlciwgJzAnLCAnTXkgRGF5Jyk7XG4gICAgY29uc3QgYWN0aXZlTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5hbGwtbGlzdCBkaXZbbGlzdC1udW1iZXI9XCIke2RlZmF1bHRMaXN0LmdldExpc3ROdW1iZXJ9XCJdYCk7XG4gICAgYWN0aXZlTGlzdC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2FjdGl2ZS1saXN0Jyk7XG4gICAgLy8gYWN0aXZlTGlzdC5jbGFzc0xpc3QudG9nZ2xlKCdkZWZhdWx0LWxpc3QnKTtcbiAgICAvLyBhY3RpdmVMaXN0LnJlbW92ZUF0dHJpYnV0ZSgnc3JjJyk7XG4gICAgLy8gYWN0aXZlTGlzdC5zZXRBdHRyaWJ1dGUoJ3NyYycsICdpY29ucy93ZWF0aGVyLXN1bm55LnBuZycpO1xuICAgIHNhdmVEYXRhKGxpc3RzLCBhY3RpdmVMaXN0TnVtYmVyKTtcbn1cblxuXG5jb25zdCBkZWZhdWx0TGlzdERPTSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hbGwtbGlzdCAuYS1saXN0Jyk7XG5jb25zdCBhbGxUb2RvRE9NUyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hbGwtdG9kbyAuYS10b2RvJyk7XG5cbmFkZFRvZG8ub25jbGljayA9ICgpID0+IHtcbiAgICBuZXdUb2RvTW9kYWwucmVtb3ZlQXR0cmlidXRlKCdpZCcpO1xufVxuXG5hZGROZXdMaXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIG5ld0xpc3RNb2RhbC5yZW1vdmVBdHRyaWJ1dGUoJ2lkJyk7XG4gICAgYWxsTGlzdC5zY3JvbGxUbygwLCBhbGxMaXN0LnNjcm9sbEhlaWdodCk7XG59KVxuXG5cbmxpc3RGb3JtLm9uc3VibWl0ID0gYWRkTGlzdDtcbmxpc3RGb3JtLm9ucmVzZXQgPSAoKSA9PiB7XG4gICAgbmV3TGlzdE1vZGFsLnNldEF0dHJpYnV0ZSgnaWQnLCAnaGlkZScpO1xufVxuXG50b2RvRm9ybS5vbnN1Ym1pdCA9IGFkZF9hX1RvZG87XG50b2RvRm9ybS5vbnJlc2V0ID0gKCkgPT4ge1xuICAgIG5ld1RvZG9Nb2RhbC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2hpZGUnKTtcbn1cblxuZGVmYXVsdExpc3RET00uZm9yRWFjaChsaXN0ID0+IHtcbiAgICBsaXN0Lm9uY2xpY2sgPSBtYWtlTGlzdEFjdGl2ZTtcbn0pO1xuXG5hbGxUb2RvRE9NUy5mb3JFYWNoKHRvZG8gPT4ge1xuICAgIHRvZG8ub25jbGljayA9IG1vZGlmeVRvZG87XG59KTsiXSwibmFtZXMiOlsiTGlzdCIsImNvbnN0cnVjdG9yIiwidGl0bGUiLCJ0b2RvcyIsImxpc3ROdW1iZXIiLCJpc0RlZmF1bHQiLCJ0aGlzIiwiZ2V0SXNEZWZhdWx0Iiwic2V0SXNEZWZhdWx0IiwidmFsdWUiLCJnZXRMaXN0TnVtYmVyIiwic2V0TGlzdE51bWJlciIsImdldFRpdGxlIiwiZ2V0VG9kb3MiLCJzZXRUb2RvcyIsInNldFRpdGxlIiwiYWRkTmV3TGlzdCIsInRoZVRvZG8iLCJwdXNoIiwiVG9kbyIsImRlc2NyaXB0aW9uIiwiZHVlRGF0ZSIsInByaW9yaXR5IiwiY29tcGxldGVkIiwidG9kb051bWJlciIsImdldFRvZG9OdW1iZXIiLCJzZXRUb2RvTnVtYmVyIiwiZ2V0SXNDb21wbGV0ZWQiLCJjaGFuZ2VDb21wbGV0ZVN0YXR1cyIsImdldERlc2NyaXB0aW9uIiwiZ2V0RHVlRGF0ZSIsImdldFByaW9yaXR5Iiwic2V0RGVzY3JpcHRpb24iLCJzZXREdWVEYXRlIiwic2V0UHJpb3JpdHkiLCJsaXN0cyIsImFkZE5ld0xpc3RJbnRlcmZhY2UiLCJsaXN0T2JqZWN0IiwiY29udGFpbmVyIiwiaW5zZXJ0X2JlZm9yZSIsImFMaXN0IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0QXR0cmlidXRlIiwiaW5zZXJ0QmVmb3JlIiwibGVmdCIsImFwcGVuZENoaWxkIiwicmlnaHQiLCJpY29uMSIsImxpc3RUaXRsZSIsInRleHRDb250ZW50IiwiaWNvbjIiLCJpY29uNSIsInJlbW92ZUV4aXN0aW5nTWFya2VyIiwibGVuZ3RoIiwiZmlyc3RMaXN0IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJnZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJuZXh0TGlzdCIsIm5leHRFbGVtZW50U2libGluZyIsInVwZGF0ZUFycmF5QW5kVG9kbyIsImFsbFRvZG9zIiwiYWxsVG9kb0luZGV4IiwiaSIsInRvZG9fbm8iLCJsaXN0X25vIiwieCIsInRoZURPTSIsImFkZE5ld1RvZG9JbnRlcmZhY2UiLCJhVG9kbyIsInRvZ2dsZSIsImNvbGxhcHNlIiwiY29sbGFwc2VJbWciLCJpbnB1dDEiLCJjaGVja2VkIiwidGl0bGVUb2RvIiwiY2hhbmdlVG9kb0hlYWRlciIsInRvZG9IZWFkZXIiLCJzaG93TGlzdHNUb2RvcyIsInRvZG8iLCJzYXZlVG9kbyIsImFuQXJyYXkiLCJsIiwidCIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJzYXZlRGF0YSIsImFjdGl2ZUxpc3ROdW1iZXIiLCJjbGVhciIsImVsZW0iLCJzYXZlRWRpdGVkTGlzdCIsImUiLCJlbGVtZW50IiwicHJldmVudERlZmF1bHQiLCJjb25zb2xlIiwibG9nIiwicGFyc2VJbnQiLCJ0YXJnZXQiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwibGFzdEVsZW1lbnRDaGlsZCIsIm1ha2VMaXN0QWN0aXZlIiwiaW5kZXgiLCJhbGxMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImRlbGV0ZVJlbGF0ZWRUb2RvIiwiYWxsVG9kbyIsInNwbGljZSIsImxpc3QiLCJ1cGRhdGVMaXN0c0FuZFRvZG9zIiwibGlzdE5vIiwicXVlcnlTZWxlY3RvciIsInNob3dSZWxhdGVkVG9kb3MiLCJkZWxldGVFbGVtZW50IiwibGlzdE5hbWVJbnB1dCIsInJlcXVpcmVkIiwibGlzdE5hbWVGb3JtIiwiZWRpdExpc3QiLCJvbnN1Ym1pdCIsInJlbW92ZUl0ZW0iLCJjaGFuZ2VDaGVjayIsIm1vZGlmeVRvZG8iLCJ0YWJsZSIsImVkaXRNb2RhbCIsImVkaXRGb3JtIiwic2VsZWN0ZWRPbmUiLCJwcmlvcml0eUlucHV0IiwiaW5wdXQiLCJzZWxlY3RlZCIsInNldFByaW9yaXR5VmFsdWUiLCJlZGl0VG9kbyIsInRvZG9ET00iLCJyZW1vdmUiLCJ1cGRhdGVUb2RvRE9NIiwidXBkYXRlRGF0YXMiLCJvbnJlc2V0IiwibmV3TGlzdGlucHV0IiwibGlzdEZvcm0iLCJuZXdMaXN0TW9kYWwiLCJhZGRUb2RvIiwibmV3VG9kb01vZGFsIiwidG9kb0Zvcm0iLCJ0b2RvTmFtZSIsImdldEl0ZW0iLCJhcnJheUxpc3RzIiwiYXJyYXlUb2RvcyIsImluY2x1ZGVzIiwibGlzdERldGFpbHMiLCJzcGxpdCIsIm5ld0xpc3QiLCJ0b2RvRGV0YWlscyIsIm5ld1RvZG8iLCJmaW5hbEFycmF5Iiwic29ydCIsImEiLCJiIiwic29ydEFycmF5cyIsImluc2VydFRvZG9zVG9MaXN0cyIsImxvYWREYXRhIiwiYWN0aXZlTGlzdCIsImxvYWRQYWdlIiwiZGVmYXVsdExpc3QiLCJkZWZhdWx0TGlzdERPTSIsImFsbFRvZG9ET01TIiwib25jbGljayIsImFkZEV2ZW50TGlzdGVuZXIiLCJzY3JvbGxUbyIsInNjcm9sbEhlaWdodCIsIm5ld0xpc3RET00iLCJ0b1N0cmluZyIsInJlc2V0IiwiZm9yRWFjaCJdLCJzb3VyY2VSb290IjoiIn0=